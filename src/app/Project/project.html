<nav class="navbar navbar-default" role="navigation">

</nav>
<div class="container">
    <!-- header section -->
    <div id="builder-project">
        <div class="page-header">
            <div class="row">
                <div class="col-md-4">
                    <img src="/assets/tival-logo-rgb.png" alt="logo" width="202px">
                    <h2>{{projectSettings.projectName}}</h2>
                    <h4>{{daysUntilDeadline}}</h4>
                </div>
                <div class="col-md-8 hidden-xs">
                    <img src="/assets/homepicture.jpg" width="100%" height="250px" alt="header">
                </div>
            </div>
        </div>

        <!-- Site -->
        <div class="row main-site">

            <!-- Left col -->
            <div class="col-md-2">

                <!-- mobile nav -->
                <div class="navbar navbar-default navbar-fixed-top visible-xs" role="navigation">

                    <div class="navbar-header">

                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse" ng-if="allCategories.length > 0">

                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>

                        </button>

                        <img src="/assets/loader24.gif" class="navbar-toggle" style="border: 0px;" alt="loading-gif" ng-if="allCategories.length == 0">

                        <a class="navbar-brand" href="javascript:void(0);">{{ currentCategoryItem.title != null ?  currentCategoryItem.title : 'Välj' }}</a>
                    </div>

                        <div class="collapse navbar-collapse">
                            <ul class="nav navbar-nav" style="margin:0 -15px">


                                <div class="panel panel-default" ng-repeat="category in allCategories" style="margin: 0px;">
                                    <div class="panel-heading">{{category.title}}</div>
                                        <ul class="list-group">
                                            <a href class="list-group-item" ng-repeat="item in category.categoryItems" ng-click="getItemOptions(item, category)" data-toggle="collapse" data-target=".navbar-collapse">
                                                {{item.title}}
                                            <span style="color: #26b6b4" class="glyphicon glyphicon-ok pull-right" aria-hidden="true" ng-if="cart[category.$id][item.key]"></span>
                                        </a>
                                    </ul>
                                </div>

                            </ul>
                        </div><!--/.nav-collapse -->
                </div><!-- /mobile nav -->

                <!-- left nav -->
                <div class="text-center hidden-xs" ng-if="allCategories.length == 0">
                    <img src="/assets/loader50.gif" alt="loading-gif">
                </div>

                <div class="panel panel-default hidden-xs" ng-repeat="category in allCategories">
                    <div class="panel-heading">{{category.title}}</div>
                    <ul class="list-group">
                        <a href class="list-group-item" ng-repeat="item in category.categoryItems" ng-click="getItemOptions(item, category)">
                            {{item.title}}
                            <span style="color: #26b6b4" class="glyphicon glyphicon-ok pull-right" aria-hidden="true" ng-if="cart[category.$id][item.key]"></span>
                        </a>
                    </ul>
                </div>
            </div>


            <!-- MAIN CONT -->
            <div class="col-md-8">

                <!-- ** New Template ** -->
                <div class="row">
                    <div ng-if="showStartPage">
                        <div class="col-md-12">
                            <h4>Titel</h4>
                        </div>
                        <div class="col-md-8">
                            <p>
                                I denna tillvalskatalog väljer ni inredning genom att kryssa i de önskade alternativen under kategorierna till vänster. När du är klar med dina val så trycker du "Gå vidare", fyller i dina uppgifter och bekräftar dina val. Du får sedan en orderbekräftelse skickad till din e-post.
                            </p>
                            <p>
                                TIVAL förbehåller sig rätten till konstruktionsförändringar
                                samt utbyte av leverantör, material och
                                sakvaror som är beroende av produktutvecklingen
                                eller andra skäl som gäller vid leveranstillfället.
                                Vi reserverar oss för tryckfel och sortimentsförändringar.
                            </p>
                            <img src="https://process.filestackapi.com/Axj8r9t8RAKP5R3oUw8J9z/resize=width:450,fit:max/https://cdn.filestackcontent.com/T3U80KP0SDOS28r7Q1c7" alt="">
                        </div>
                        <div class="col-md-4">
                            <img src="https://process.filestackapi.com/Axj8r9t8RAKP5R3oUw8J9z/resize=width:425,fit:max/https://cdn.filestackcontent.com/E04OUnBRTKcmuXqHT7b2" alt="">
                        </div>
                    </div>

                    <!-- item -->
                    <div ng-repeat="option in itemOptions" ng-if="itemOptions.length > 1">

                        <div class="new-line" ng-show="itemOptions[$index-1].default != option.default">
                            <div class="col-md-12">
                                <h4 ng-show="option.default">Standard</h4>
                                <h4 ng-show="!option.default">Tillval</h4>
                            </div>
                        </div>

                        <div class="col-md-4 col-xs-6 option-item">

                            <div class="option-inner">

                                <div class="imgholder">
                                    <img ng-src="https://process.filestackapi.com/Axj8r9t8RAKP5R3oUw8J9z/resize=width:125,height:125,fit:clip/{{option.image}}" ng-click="zoomItemOption(option, true)">
                                </div>

                                <h4>{{option.title}}</h4>

                                <p class="option-description">{{option.desc}}</p>

                                <div><span>{{htmlHelper.formatPrice(option.price)}} {{htmlHelper.priceSuffix()}}</span></div>
                                <p></p>

                                <button class="btn btn-block btn-xs" ng-if="!customer.confirmed" ng-class="(cart[currentCategory.$id][currentCategoryItem.key].key == option.key) ? 'btn-builder-active':'btn-default'" ng-click="selectOption(option, currentCategoryItem)">{{ (cart[currentCategory.$id][currentCategoryItem.key].key == option.key) == true ? 'Vald' : 'Välj'; }}</button>

                            </div>
                        </div>
                    </div>
                    <!-- /item -->

                </div><!-- /row -->

                <!-- ** Full page item ** -->
                <div class="col-md-12" ng-repeat="option in itemOptions | onlyActive" ng-if="itemOptions.length === 1">

                    <div class="col-md-4">
                        <p></p>
                        <div><img class="img-responsive" ng-src="{{option.image}}" ng-click="zoomItemOption(option)"></div>
                    </div>

                <div class="panel panel-default">
                <div class="panel-body">
                    <p class="lead">{{option.title}}</p>
                    <p class="option-description">{{option.desc}}</p>
                    <p></p>
                    <div class="card-footer text-muted">

                        <div class="btn-group" id="toggle_event_editing" ng-if="!customer.confirmed">
                            <button type="button" class="btn" ng-class="(cart[currentCategory.$id][currentCategoryItem.key].price == option.price) ? 'btn-builder-active':'btn-default'" ng-click="selectOption(option, currentCategoryItem, true, true)">Ja</button>
                            <button type="button" class="btn" ng-class="!(cart[currentCategory.$id][currentCategoryItem.key].price == option.price) ? 'btn-builder-active':'btn-default'" ng-click="selectOption(option, currentCategoryItem, true, false)">Nej</button>
                        </div>
                        <span class="pull-right">Pris: {{htmlHelper.formatPrice(option.price)}} {{htmlHelper.priceSuffix()}}</span>
                    </div>
                    <p></p>
                </div>
                </div>
                </div>
                <!-- /full page item -->
            </div>

            <!-- your choices -->
            <div class="col-md-2" ng-if="customer && !customer.confirmed && cart && itemOptions">

                <div class="panel panel-default">
                    <div class="panel-heading">
                        Mina val
                    </div>

                    <ul class="list-group">
                        <li class="list-group-item">
                            <span ng-repeat="categoryItems in cart">
                                <span ng-repeat="item in categoryItems">
                                    <div ng-if="item != categoryItems.categoryTitle">
                                        <span class="small">{{item.categoryItemTitle}}</span><span class="pull-right small">{{htmlHelper.formatPrice(item.price)}} {{htmlHelper.priceSuffix()}}</span><br>
                                    </div>
                                </span>
                            </span>
                        </li>
                    </ul>
                    <ul class="list-group">
                        <li class="list-group-item" ng-if="totalPrice">
                            Total:<span class="pull-right">{{htmlHelper.formatPrice(totalPrice)}} {{htmlHelper.priceSuffix()}}</span>
                        </li>
                    </ul>
                </div>
                <!-- /dina val som ska synas -->

                <button class="btn btn-default pull-right" ng-click="toggleModal('summary')" style="margin: 15px;">Gå vidare</button>

            </div>

        </div>
    </div>

    <div id="lightbox-overlay" ng-show="displayLightbox" ng-click="displayLightbox = !displayLightbox"></div>
    <div id="lightbox" ng-show="displayLightbox">
        <div class="lightbox-close" ng-click="displayLightbox = !displayLightbox">x</div>
        <div class="lightbox-header">{{lightboxData.title}}</div>
        <div class="lightbox-content">
            <img class="lightbox-img" ng-src="{{lightboxImage}}">
        </div>
    </div>

    <modal class="project-summary-modal" title="Bekräfta dina val" visible="modalSummary">

        <div ng-show="!customer.confirmed">
            <form class="form-horizontal" role="form" name="customerForm" ng-disabled="customer.confirmed" required ng-submit="areYouSureDialog = true">
                <div class="row">

                    <div class="col-xs-12 col-md-6">
                        <label>Namn <span>*</span>
                            <input type="text" class="form-control" placeholder="" ng-model="customer.name" ng-change="customer.$save()" required>
                        </label>
                    </div>

                    <div class="col-xs-12 col-md-6">
                        <label>Bostadsnr <span>*</span>
                            <input type="text" class="form-control" placeholder="" ng-model="customer.appartmentnumber" ng-change="customer.$save()" required>
                        </label>
                    </div>

                    <div class="col-xs-12 col-md-6">
                        <label>Epost <span>*</span>
                            <input type="email" class="form-control" placeholder="" ng-model="customer.email" ng-change="customer.$save()" required>
                        </label>
                    </div>
                    <div class="col-xs-12 col-md-6">
                        <label>Telefon <span>*</span>
                            <input type="text" class="form-control" placeholder="" ng-model="customer.phone" ng-change="customer.$save()" required>
                        </label>
                    </div>

                </div>
                <hr>

            <span ng-repeat="categoryItems in cart">
                <label>{{categoryItems.categoryTitle}}</label>
                <span ng-repeat="item in categoryItems">

                    <div ng-if="categoryItems.categoryTitle != item">
                        {{item.categoryItemTitle}}: {{item.title}}<span class="pull-right">{{ htmlHelper.formatPrice(item.price) + htmlHelper.priceSuffix()}}</span><br>
                    </div>
                </span>
            </span>

            <hr>
            <span ng-if="totalPrice">
                <label>Totalt:</label><span class="pull-right">{{htmlHelper.formatPrice(totalPrice)}} {{htmlHelper.priceSuffix()}}</span>
            </span>

                <div class="row">
                    <div class="col-xs-12 text-right" ng-show="!areYouSureDialog">
                        <p></p>
                        <button type="submit" class="btn btn-default m-t-10">Bekräfta</button>
                    </div>
                    <div class="col-xs-12 text-right" ng-show="areYouSureDialog && !sendingMail">
                        <label style="margin-right: 3px" class="m-t-10">Detta är slutgiltigt, är ni säkra?</label>

                        <button type="button" style="margin-right: 3px" class="btn btn-default m-t-10" ng-click="saveAndConfirm()">Ja</button>
                        <button type="button" class="btn btn-default m-t-10" ng-click="areYouSureDialog = false">Nej</button>
                    </div>

                    <div class="col-xs-12 text-right" ng-show="sendingMail">
                        <img src="/assets/loader50.gif" alt="loading-gif">
                    </div>
                </div>
            </form>
        </div>

        <div class="row" ng-show="customer.confirmed">
            <div class="col-md-12" >
                <h2>Tack för din beställning!</h2>
                <br>
                <p>Du får även en orderbekräftelse skickad till din e-post</p>

                <button class="btn btn-success" ng-click="downloadPDF()">Spara som PDF</button>

                <hr>
            </div>
        </div>

    </modal>

</div>
